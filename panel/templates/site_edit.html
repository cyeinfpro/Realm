{% extends "base.html" %}
{% block content %}
<div class="hero-card">
  <div class="hero-left">
    <span class="pill xs ghost">Edit</span>
    <div class="hero-title">编辑站点 · {{ site.name }}</div>
    <div class="hero-sub">节点：{{ node.name if node else '-' }} · 域名：<span class="mono">{{ (site.domains or [])|join(', ') }}</span></div>
  </div>
  <div class="hero-right">
    <a class="btn sm ghost" href="/websites/{{ site.id }}">返回站点</a>
  </div>
</div>

<div class="card" style="margin-top:12px;">
  <form method="post" action="/websites/{{ site.id }}/edit" class="form">
    <div class="form-section">
      <div class="section-head">
        <div>
          <div class="section-title">基础信息</div>
          <div class="section-sub">名称与域名。</div>
        </div>
      </div>
      <div class="form-grid">
        <div class="col">
          <label class="label">站点名称</label>
          <input class="input" name="name" value="{{ site.name or '' }}" placeholder="例如：官网 / 客户A">
          <div class="help">留空默认使用主域名。</div>
        </div>
        <div class="col">
          <label class="label">域名（支持多个）</label>
          <input class="input" name="domains" value="{{ site.domains_text }}" placeholder="example.com, www.example.com" required>
          <div class="help">多个域名用逗号或空格分隔。</div>
        </div>
      </div>
    </div>

    <div class="form-section">
      <div class="section-head">
        <div>
          <div class="section-title">站点类型</div>
          <div class="section-sub">调整类型将重写 Nginx 配置。</div>
        </div>
      </div>
      <div class="form-grid">
        <div class="col">
          <label class="label">站点类型</label>
          <select class="select" name="site_type">
            <option value="static" {% if site.type == 'static' %}selected{% endif %}>静态站点</option>
            <option value="php" {% if site.type == 'php' %}selected{% endif %}>PHP 站点</option>
            <option value="reverse_proxy" {% if site.type == 'reverse_proxy' %}selected{% endif %}>反向代理</option>
          </select>
        </div>
        <div class="col">
          <label class="label">Web 服务器</label>
          <select class="select" name="web_server">
            <option value="nginx" selected>nginx</option>
          </select>
        </div>
      </div>
    </div>

    <div class="form-section">
      <div class="section-head">
        <div>
          <div class="section-title">运行配置</div>
          <div class="section-sub">根目录与代理目标。</div>
        </div>
      </div>
      <div class="form-grid">
        <div class="col">
          <label class="label">根目录</label>
          <input class="input" name="root_path" value="{{ site.root_path or '' }}" placeholder="例如：/www/wwwroot/example.com">
          <div class="help">静态/PHP 必填；反向代理可留空。</div>
        </div>
        <div class="col">
          <label class="label">反向代理目标</label>
          <input class="input" name="proxy_target" value="{{ site.proxy_target or '' }}" placeholder="127.0.0.1:8080 或 http://127.0.0.1:8080">
          <div class="help">系统会自动补全 http://。</div>
        </div>
      </div>
      <div class="row" style="gap:12px;margin-top:6px;">
        <label class="help"><input type="checkbox" name="https_redirect" {% if site.https_redirect %}checked{% endif %} style="transform:translateY(1px);"> 证书就绪后强制 HTTPS</label>
        <label class="help"><input type="checkbox" name="gzip_enabled" {% if site.gzip_enabled %}checked{% endif %} style="transform:translateY(1px);"> 启用 Gzip</label>
      </div>
    </div>

    <div class="form-section">
      <div class="section-head">
        <div>
          <div class="section-title">模板扩展</div>
          <div class="section-sub">可选自定义 Nginx 配置模板。</div>
        </div>
      </div>
      <label class="label">自定义 Nginx 模板（可选）</label>
      <textarea class="textarea" name="nginx_tpl" rows="8" placeholder="支持变量：{{SERVER_NAME}} {{ROOT_PATH}} {{PROXY_TARGET}} {{SSL_CERT}} {{SSL_KEY}} {{GZIP_CONF}}">{{ site.nginx_tpl or '' }}</textarea>
      <div class="help">留空则使用内置模板；自定义模板需自行处理 80/443 与 SSL。</div>
    </div>

    <div class="row" style="margin-top:12px;">
      <div class="col">
        <a href="/websites/{{ site.id }}" class="btn ghost">取消</a>
      </div>
      <div class="col right">
        <button class="btn" type="submit">保存修改</button>
      </div>
    </div>
  </form>
</div>
{% endblock %}
