{% extends "base.html" %}
{% block content %}
<div class="page-head">
  <div class="page-title">
    <h1 class="h1">接入节点</h1>
    <div class="meta">
      <span class="meta-item">填写节点名称与地址，系统会自动生成密钥并建立接入配置。</span>
    </div>
  </div>
  <div class="right">
    <a href="/" class="btn sm ghost">返回控制台</a>
  </div>
</div>

<div class="center-wrap lg">
  <div class="auth-head">
    <div class="h2">节点接入向导</div>
    <div class="auth-sub">默认端口为 {{ default_port }}，地址中可追加端口；提交后会生成 API Key 并保存节点。</div>
    <div class="auth-meta">
      <span class="pill xs ghost">默认端口 {{ default_port }}</span>
      <span class="pill xs ghost">自动生成 API Key</span>
    </div>
  </div>

  <div class="card center-card">
    <form method="post" action="/nodes/new" class="form">
      <label class="label">节点名称</label>
      <input class="input" name="name" placeholder="例如：北京-主机01">

      <label class="label">分组名称</label>
      <input class="input" name="group_name" placeholder="例如：香港 / 美国 / 客户A" value="默认分组">
      <div class="help">仅用于面板分类；不影响规则与转发。</div>

      <label class="label">内网机器</label>
      <label class="help"><input type="checkbox" name="is_private" style="transform:translateY(1px);"> 勾选后将标记为“内网出口节点”（用于内网穿透/反向隧道）</label>

      <label class="label">网站机</label>
      <label class="help"><input type="checkbox" name="is_website" style="transform:translateY(1px);"> 勾选后可在「网站管理」中管理站点、SSL 与文件</label>

      <label class="label">网站根目录</label>
      <input class="input" name="website_root_base" placeholder="/www" value="/www">
      <div class="help">用于文件管理的根目录限制（默认 /www）。</div>

      <label class="label">节点 IP 地址</label>
      <input class="input" name="ip_address" placeholder="10.0.0.2" required>
      <div class="help">请输入主机/IP；默认端口 {{ default_port }}（无需填写）。</div>

      <label class="label">协议</label>
      <select class="select" name="scheme">
        <option value="http">http</option>
        <option value="https">https</option>
      </select>
      <div class="help">用于生成 API 地址；HTTPS 场景请选择 https。</div>

      <label class="label">TLS 校验</label>
      <label class="help"><input type="checkbox" name="verify_tls" value="1" checked style="transform:translateY(1px);"> 校验证书（HTTPS 推荐开启；自签证书可关闭）</label>

      <!-- 端口已隐藏：统一使用标准端口 {{ default_port }} -->
      <input type="hidden" name="api_key" value="{{ api_key }}">

      <div class="row" style="margin-top:14px;">
        <div class="col">
          <a href="/" class="btn ghost">返回控制台</a>
        </div>
        <div class="col right">
          <button class="btn" type="submit">生成接入配置</button>
        </div>
      </div>
    </form>
  </div>
</div>
{% endblock %}
